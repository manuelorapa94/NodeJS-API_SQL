"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.errorParser = errorParser;
exports.infoParser = infoParser;
var _token = require("./token");
function parseToken(parser, options, callback) {
  // length
  parser.readUInt16LE(() => {
    parser.readUInt32LE(number => {
      parser.readUInt8(state => {
        parser.readUInt8(clazz => {
          parser.readUsVarChar(message => {
            parser.readBVarChar(serverName => {
              parser.readBVarChar(procName => {
                (options.tdsVersion < '7_2' ? parser.readUInt16LE : parser.readUInt32LE).call(parser, lineNumber => {
                  callback({
                    'number': number,
                    'state': state,
                    'class': clazz,
                    'message': message,
                    'serverName': serverName,
                    'procName': procName,
                    'lineNumber': lineNumber
                  });
                });
              });
            });
          });
        });
      });
    });
  });
}
function infoParser(parser, options, callback) {
  parseToken(parser, options, data => {
    callback(new _token.InfoMessageToken(data));
  });
}
function errorParser(parser, options, callback) {
  parseToken(parser, options, data => {
    callback(new _token.ErrorMessageToken(data));
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdG9rZW4iLCJyZXF1aXJlIiwicGFyc2VUb2tlbiIsInBhcnNlciIsIm9wdGlvbnMiLCJjYWxsYmFjayIsInJlYWRVSW50MTZMRSIsInJlYWRVSW50MzJMRSIsIm51bWJlciIsInJlYWRVSW50OCIsInN0YXRlIiwiY2xhenoiLCJyZWFkVXNWYXJDaGFyIiwibWVzc2FnZSIsInJlYWRCVmFyQ2hhciIsInNlcnZlck5hbWUiLCJwcm9jTmFtZSIsInRkc1ZlcnNpb24iLCJjYWxsIiwibGluZU51bWJlciIsImluZm9QYXJzZXIiLCJkYXRhIiwiSW5mb01lc3NhZ2VUb2tlbiIsImVycm9yUGFyc2VyIiwiRXJyb3JNZXNzYWdlVG9rZW4iXSwic291cmNlcyI6WyIuLi8uLi9zcmMvdG9rZW4vaW5mb2Vycm9yLXRva2VuLXBhcnNlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUGFyc2VyLCB7IFBhcnNlck9wdGlvbnMgfSBmcm9tICcuL3N0cmVhbS1wYXJzZXInO1xuXG5pbXBvcnQgeyBJbmZvTWVzc2FnZVRva2VuLCBFcnJvck1lc3NhZ2VUb2tlbiB9IGZyb20gJy4vdG9rZW4nO1xuXG5pbnRlcmZhY2UgVG9rZW5EYXRhIHtcbiAgbnVtYmVyOiBudW1iZXI7XG4gIHN0YXRlOiBudW1iZXI7XG4gIGNsYXNzOiBudW1iZXI7XG4gIG1lc3NhZ2U6IHN0cmluZztcbiAgc2VydmVyTmFtZTogc3RyaW5nO1xuICBwcm9jTmFtZTogc3RyaW5nO1xuICBsaW5lTnVtYmVyOiBudW1iZXI7XG59XG5cbmZ1bmN0aW9uIHBhcnNlVG9rZW4ocGFyc2VyOiBQYXJzZXIsIG9wdGlvbnM6IFBhcnNlck9wdGlvbnMsIGNhbGxiYWNrOiAoZGF0YTogVG9rZW5EYXRhKSA9PiB2b2lkKSB7XG4gIC8vIGxlbmd0aFxuICBwYXJzZXIucmVhZFVJbnQxNkxFKCgpID0+IHtcbiAgICBwYXJzZXIucmVhZFVJbnQzMkxFKChudW1iZXIpID0+IHtcbiAgICAgIHBhcnNlci5yZWFkVUludDgoKHN0YXRlKSA9PiB7XG4gICAgICAgIHBhcnNlci5yZWFkVUludDgoKGNsYXp6KSA9PiB7XG4gICAgICAgICAgcGFyc2VyLnJlYWRVc1ZhckNoYXIoKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIHBhcnNlci5yZWFkQlZhckNoYXIoKHNlcnZlck5hbWUpID0+IHtcbiAgICAgICAgICAgICAgcGFyc2VyLnJlYWRCVmFyQ2hhcigocHJvY05hbWUpID0+IHtcbiAgICAgICAgICAgICAgICAob3B0aW9ucy50ZHNWZXJzaW9uIDwgJzdfMicgPyBwYXJzZXIucmVhZFVJbnQxNkxFIDogcGFyc2VyLnJlYWRVSW50MzJMRSkuY2FsbChwYXJzZXIsIChsaW5lTnVtYmVyOiBudW1iZXIpID0+IHtcbiAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHtcbiAgICAgICAgICAgICAgICAgICAgJ251bWJlcic6IG51bWJlcixcbiAgICAgICAgICAgICAgICAgICAgJ3N0YXRlJzogc3RhdGUsXG4gICAgICAgICAgICAgICAgICAgICdjbGFzcyc6IGNsYXp6LFxuICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZSc6IG1lc3NhZ2UsXG4gICAgICAgICAgICAgICAgICAgICdzZXJ2ZXJOYW1lJzogc2VydmVyTmFtZSxcbiAgICAgICAgICAgICAgICAgICAgJ3Byb2NOYW1lJzogcHJvY05hbWUsXG4gICAgICAgICAgICAgICAgICAgICdsaW5lTnVtYmVyJzogbGluZU51bWJlclxuICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5mb1BhcnNlcihwYXJzZXI6IFBhcnNlciwgb3B0aW9uczogUGFyc2VyT3B0aW9ucywgY2FsbGJhY2s6ICh0b2tlbjogSW5mb01lc3NhZ2VUb2tlbikgPT4gdm9pZCkge1xuICBwYXJzZVRva2VuKHBhcnNlciwgb3B0aW9ucywgKGRhdGEpID0+IHtcbiAgICBjYWxsYmFjayhuZXcgSW5mb01lc3NhZ2VUb2tlbihkYXRhKSk7XG4gIH0pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXJyb3JQYXJzZXIocGFyc2VyOiBQYXJzZXIsIG9wdGlvbnM6IFBhcnNlck9wdGlvbnMsIGNhbGxiYWNrOiAodG9rZW46IEVycm9yTWVzc2FnZVRva2VuKSA9PiB2b2lkKSB7XG4gIHBhcnNlVG9rZW4ocGFyc2VyLCBvcHRpb25zLCAoZGF0YSkgPT4ge1xuICAgIGNhbGxiYWNrKG5ldyBFcnJvck1lc3NhZ2VUb2tlbihkYXRhKSk7XG4gIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRUEsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBWUEsU0FBU0MsVUFBVUEsQ0FBQ0MsTUFBYyxFQUFFQyxPQUFzQixFQUFFQyxRQUFtQyxFQUFFO0VBQy9GO0VBQ0FGLE1BQU0sQ0FBQ0csWUFBWSxDQUFDLE1BQU07SUFDeEJILE1BQU0sQ0FBQ0ksWUFBWSxDQUFFQyxNQUFNLElBQUs7TUFDOUJMLE1BQU0sQ0FBQ00sU0FBUyxDQUFFQyxLQUFLLElBQUs7UUFDMUJQLE1BQU0sQ0FBQ00sU0FBUyxDQUFFRSxLQUFLLElBQUs7VUFDMUJSLE1BQU0sQ0FBQ1MsYUFBYSxDQUFFQyxPQUFPLElBQUs7WUFDaENWLE1BQU0sQ0FBQ1csWUFBWSxDQUFFQyxVQUFVLElBQUs7Y0FDbENaLE1BQU0sQ0FBQ1csWUFBWSxDQUFFRSxRQUFRLElBQUs7Z0JBQ2hDLENBQUNaLE9BQU8sQ0FBQ2EsVUFBVSxHQUFHLEtBQUssR0FBR2QsTUFBTSxDQUFDRyxZQUFZLEdBQUdILE1BQU0sQ0FBQ0ksWUFBWSxFQUFFVyxJQUFJLENBQUNmLE1BQU0sRUFBR2dCLFVBQWtCLElBQUs7a0JBQzVHZCxRQUFRLENBQUM7b0JBQ1AsUUFBUSxFQUFFRyxNQUFNO29CQUNoQixPQUFPLEVBQUVFLEtBQUs7b0JBQ2QsT0FBTyxFQUFFQyxLQUFLO29CQUNkLFNBQVMsRUFBRUUsT0FBTztvQkFDbEIsWUFBWSxFQUFFRSxVQUFVO29CQUN4QixVQUFVLEVBQUVDLFFBQVE7b0JBQ3BCLFlBQVksRUFBRUc7a0JBQ2hCLENBQUMsQ0FBQztnQkFDSixDQUFDLENBQUM7Y0FDSixDQUFDLENBQUM7WUFDSixDQUFDLENBQUM7VUFDSixDQUFDLENBQUM7UUFDSixDQUFDLENBQUM7TUFDSixDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSjtBQUVPLFNBQVNDLFVBQVVBLENBQUNqQixNQUFjLEVBQUVDLE9BQXNCLEVBQUVDLFFBQTJDLEVBQUU7RUFDOUdILFVBQVUsQ0FBQ0MsTUFBTSxFQUFFQyxPQUFPLEVBQUdpQixJQUFJLElBQUs7SUFDcENoQixRQUFRLENBQUMsSUFBSWlCLHVCQUFnQixDQUFDRCxJQUFJLENBQUMsQ0FBQztFQUN0QyxDQUFDLENBQUM7QUFDSjtBQUVPLFNBQVNFLFdBQVdBLENBQUNwQixNQUFjLEVBQUVDLE9BQXNCLEVBQUVDLFFBQTRDLEVBQUU7RUFDaEhILFVBQVUsQ0FBQ0MsTUFBTSxFQUFFQyxPQUFPLEVBQUdpQixJQUFJLElBQUs7SUFDcENoQixRQUFRLENBQUMsSUFBSW1CLHdCQUFpQixDQUFDSCxJQUFJLENBQUMsQ0FBQztFQUN2QyxDQUFDLENBQUM7QUFDSiJ9